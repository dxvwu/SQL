#In this SQL, I'm querying a database with multiple tables in it to quantify statistics about customer and order data. 

#1. How many orders were placed in January? 
SELECT COUNT(distinct orderid)
FROM BIT_DB.JanSales

#2. How many of those orders were for an iPhone? 
SELECT COUNT(DISTINCT orderid)
FROM BIT_DB.JanSales
WHERE Product = 'iPhone'

#3. Select the customer account numbers for all the orders that were placed in February. 
SELECT DISTINCT acctnum
FROM BIT_DB.customers cust
INNER JOIN BIT_DB.FebSales Feb
ON cust.order_id = FEB.orderid

#4. Which product was the cheapest one sold in January, and what was the price? 
SELECT DISTINCT Product, Price
FROM BIT_DB.JanSales
ORDER BY price ASC LIMIT 1;

#5. What is the total revenue for each product sold in January?
SELECT SUM(quantity)*price AS Revenue , product
FROM BIT_DB.JanSales
GROUP BY product;

#6. Which products were sold in February at 548 Lincoln St, Seattle, WA 98101, how many of each were sold, and what was the total revenue?
SELECT SUM(Quantity), product, SUM(Quantity)*price AS Revenue
FROM BIT_DB.FebSales
WHERE location = '548 Lincoln St, Seattle, WA 98101'
GROUP BY product;

#7. How many customers ordered more than 2 products at a time, and what was the average amount spent for those customers? 
SELECT count(DISTINCT cust.acctnum), AVG(quantity*price)
FROM BIT_DB.FebSales Feb
LEFT JOIN BIT_DB.customers cust
ON FEB.orderid = cust.order_id
WHERE Feb.Quantity > 2

Practice 1
We'll start with this query:
SELECT employee_ID
FROM employees

Which of the following lines of code will complete the query listed above so that it only retrieves employee IDs (employee_ID)) that:
1. Start with ‘14’
2. Have a single character after ‘14’
3. End with ‘9’

Wildcard Practice 1
Example	Code
A	WHERE employee_ID = '14_9'
B	WHERE employee_ID LIKE '14_9'
C	WHERE employee_ID LIKE 14_9
D	WHERE employee_ID LIKE '14'_'9'

Answer: B) WHERE employee_ID LIKE '14_9'

Practice 2
Let’s say we need to find all orderIDs in the MarSales table from the BIT_DB database where the orderID has the characters ‘16’ in the beginning, followed by one unknown character, then a ‘0’, and any number of characters for the rest.
SELECT orderID
FROM BIT_DB.MarSales

Which of the following lines of code will complete the query listed above so that it only retrieves employee IDs (employee_ID)) that:
Start with ‘16’
Have a single character after ‘16’
Followed by ‘0’
And any number of characters in the last position

Wildcard Practice 2
Example	Code
A	WHERE orderID LIKE '16%0_'
B	WHERE orderID LIKE '16%0%'
C	WHERE orderID LIKE '160_%'
D	WHERE orderID LIKE '16_0%'

Answer: D) WHERE orderID LIKE '16_0%'

Advanced Customer & Order Analytics

Query 1
How many of each type of headphone were sold in February?
In other words, what is the sum of the quantity of products sold that have “headphones” in the name from the February dataset? Group the results by product.
SELECT SUM(Quantity), Product
FROM BIT_DB.FebSales
WHERE Product LIKE '%Headphones%'
GROUP BY Product

Query 2
What was the average amount spent per account in February?
In other words, what is the average amount spent / number of accounts, not the amount spent by each account.
SELECT avg(quantity*price)
FROM BIT_DB.FebSales Feb
LEFT JOIN BIT_DB.customers cust
ON FEB.orderid=cust.order_id

Query 3
Find order ids from Georgia (GA) where the order has an average price greater than $1,000. Only find orders from dates beginning with ‘04/1’. Assume that the dates are stored in the MM/DD/YY HH:MM format.
SELECT orderID
FROM BIT_DB.AprSales
WHERE orderdate LIKE '04/1%'
AND location LIKE '%GA%'
GROUP BY orderID
HAVING AVG(price) > 1000;

Query 4
You’ve been given the following results from the MaySales table. Can you reverse engineer a SQL query that returns these results?
The result set will naturally only return 10 rows (i.e., you will not have to use LIMIT to get to 10 results).
SELECT location, orderID
FROM BIT_DB.MaySales
WHERE orderID LIKE '1943_5'
ORDER BY orderID;

Query 5
Which product brought in the most revenue in January and how much revenue did it bring in total?
In other words, show the one product that generated the most revenue (revenue being equivalent to quantity of an item multiplied by the item’s price). 
SELECT product, sum(quantity*price)
FROM BIT_DB.JanSales
GROUP BY product
ORDER BY sum(quantity*price) desc
LIMIT 1
